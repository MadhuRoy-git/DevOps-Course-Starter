services:
    - docker
before_script:
    - docker login -u $DOCKER_USER -p $DOCKER_PASSWORD
script:
    - docker build --target test --tag my-test-image .
    - docker run my-test-image tests/unit
    - docker run my-test-image tests/integration
    - docker run --env apiKey --env apiToken --env boardId --env TODO_LIST_ID --env DOING_LIST_ID --env DONE_LIST_ID --env FLASK_APP --env FLASK_ENV my-test-image tests/endtoend
    - docker build --target production --tag $DOCKER_USER/todo-app:latest .  
    - docker push $DOCKER_USER/todo-app:latest